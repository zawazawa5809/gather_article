# リサーチ結果: npm vs pnpm

## 調査概要

- 調査日時: 2025-09-06T18:52:51
- 検索範囲: both (日英両方) / 深度: detailed / 期間: 2024-2025
- 検索手段: web.search (WebSearch API)
- 総検索回数: 7回
- 収集情報源数: 約50件

## 主要な発見事項

### 1. 定義/仕様

#### npm (Node Package Manager)
- Node.js標準のパッケージマネージャー[1]
- 2010年にリリース、最も広く使用されている[2]
- フラット化された依存関係ツリー構造（v3以降）[3]
- 180万以上のパッケージを提供（2024年時点）[4]

#### pnpm (Performant npm)
- 高速で効率的なパッケージマネージャー[5]
- コンテンツアドレス可能ストア方式を採用[6]
- ハードリンクとシンボリックリンクによる2層構造[7]
- npmの上位互換性を保持[8]

### 2. 公式発表

#### pnpm公式ベンチマーク（2025年8月31日更新）
- クリーンインストール時間：npmの約35%（65%削減）[9]
- ディスク使用量：最大70%削減[10]
- 日次更新される公式ベンチマークサイトを運用[11]

#### 主要フレームワークの移行（2022-2024）
- Next.js、Vite、Nuxt、Astro、Prismaがpnpmへ移行完了[12]
- 移行理由：パフォーマンス向上とディスク効率化[13]

## 詳細情報

### アーキテクチャの違い

#### npm
- **依存関係管理**: フラット化されたnode_modules構造[14]
- **ストレージ**: 各プロジェクトで個別に依存関係をコピー[15]
- **ホイスティング**: すべての依存関係をルートレベルにホイスト[16]

#### pnpm
- **依存関係管理**: 厳密なnode_modules構造（シンボリックリンク使用）[17]
- **ストレージ**: グローバルコンテンツアドレス可能ストア（~/.pnpm-store）[18]
- **ホイスティング**: 直接依存関係のみホイスト（意図しないインポート防止）[19]

### パフォーマンス比較（2025年最新）

#### インストール速度
- **初回インストール（キャッシュなし）**：
  - pnpm: 16秒
  - npm: 61秒
  - Yarn: 46秒[20]

#### ディスク使用量
- **100プロジェクトで同じ依存関係を使用した場合**：
  - pnpm: 1回分のストレージのみ
  - npm: 100回分のストレージ[21]

### モノレポサポート

#### npm
- workspaces機能でモノレポをサポート[22]
- 基本的な機能のみ提供[23]

#### pnpm
- ネイティブworkspacesサポート[24]
- Turborepoとの組み合わせが推奨（2024年ベストプラクティス）[25]
- Netflix、Datadogなど大規模企業での採用実績[26]

### セキュリティ面

#### npm
- 継続的なセキュリティ改善[27]
- 脆弱性検出機能の強化（2024-2025）[28]

#### pnpm
- 厳密な依存関係による意図しないパッケージアクセスの防止[29]
- package.jsonに記載のないパッケージの使用を構造的に不可能に[30]

### 使い分けガイドライン（2025年推奨）

#### npmを選ぶべき場合
- シンプルなプロジェクト[31]
- 互換性と安定性を最優先する場合[32]
- 追加のパッケージマネージャーをインストールしたくない場合[33]

#### pnpmを選ぶべき場合
- 大規模プロジェクトやモノレポ[34]
- インストール速度とディスク効率を重視[35]
- 最新の開発ツールを積極的に採用したい場合[36]

## 信頼性評価

### 高信頼性（スコア 8-10）
- **pnpm公式ドキュメント**（スコア10）：一次情報源、日次更新
- **主要フレームワーク公式ブログ**（スコア9）：移行事例の公式発表
- **公式ベンチマークサイト**（スコア9）：自動更新される実測データ

### 中信頼性（スコア 5-7）
- **技術ブログ記事**（スコア6）：実装経験に基づく情報
- **比較記事**（スコア7）：複数ソースの情報を統合

### 要検証（スコア ≤4）
- 個人ブログの主観的評価（スコア3）
- 古い情報（2023年以前）（スコア2）

## 技術的詳細

### pnpmの2層リンク構造

1. **ハードリンク層（ストア → .pnpm）**
   - グローバルストアから.pnpmディレクトリへハードリンク[37]
   - 例：`node_modules/.pnpm/foo@1.0.0/node_modules/foo/index.js` → `<store>/003...`[38]

2. **シンボリックリンク層（依存関係ツリー構築）**
   - .pnpm内でパッケージ間の依存関係をシンボリックリンクで構築[39]
   - 直接依存のみルートnode_modulesへシンボリックリンク[40]

### プラットフォーム固有の実装

#### Windows
- シンボリックリンクの代わりにジャンクションを使用[41]
- 管理者権限不要で動作[42]

#### Copy-on-Write対応
- Btrfsなどのファイルシステムでclone方式を推奨[43]
- 最速かつ最も安全な方法として公式推奨[44]

## 移行ガイド

### npmからpnpmへの移行手順
1. `npm install -g pnpm`でpnpmをインストール[45]
2. `pnpm import`でpackage-lock.jsonをpnpm-lock.yamlに変換[46]
3. `node_modules`とpackage-lock.jsonを削除[47]
4. `pnpm install`で再インストール[48]

## 今後の展望（2025年）

- pnpmのさらなる高速化と効率化[49]
- 主要IDEやツールチェーンでのネイティブサポート拡大[50]
- エンタープライズ採用の加速[51]

## 参考URL

[1] npm公式サイト - https://www.npmjs.com - Node.js標準パッケージマネージャーの公式サイト
[2] npm vs pnpm比較 - https://pnpm.io/pnpm-vs-npm - pnpm公式による詳細比較
[3] npm v3リリースノート - https://docs.npmjs.com - フラット化構造の導入
[4] npm統計情報 - https://www.npmjs.com - 180万パッケージの提供
[5] pnpm公式サイト - https://pnpm.io - 高速で効率的なパッケージマネージャー
[6] pnpmアーキテクチャ - https://pnpm.io/motivation - コンテンツアドレス可能ストアの説明
[7] シンボリックリンク構造 - https://pnpm.io/symlinked-node-modules-structure - 2層構造の技術詳細
[8] npm互換性 - https://pnpm.io/faq - npmとの互換性に関するFAQ
[9] pnpmベンチマーク - https://pnpm.io/benchmarks - 公式パフォーマンステスト結果
[10] ディスク使用量比較 - https://refine.dev/blog/pnpm-vs-npm-and-yarn/ - 70%削減の詳細
[11] 日次ベンチマーク - https://pnpm.io/benchmarks - 毎日更新される性能測定
[12] フレームワーク移行 - https://dev.to/thelogicwarlock/pnpm-vs-npm-why-you-should-switch-in-2025-4egg - 主要フレームワークの移行事例
[13] 移行理由分析 - https://divriots.com/blog/switching-to-pnpm/ - 移行の技術的理由
[14] npmフラット構造 - https://docs.npmjs.com - node_modules構造の説明
[15] npmストレージ - https://www.milesweb.com/blog/technology-hub/npm-vs-pnpm/ - ストレージ方式の比較
[16] npmホイスティング - https://docs.npmjs.com - ホイスティング動作の詳細
[17] pnpm厳密構造 - https://pnpm.io/symlinked-node-modules-structure - 厳密な依存関係管理
[18] グローバルストア - https://pnpm.io/motivation - コンテンツアドレス可能ストアの位置
[19] 選択的ホイスティング - https://pnpm.io/faq - 直接依存のみのホイスト
[20] インストール速度比較 - https://www.syncfusion.com/blogs/post/pnpm-vs-npm-vs-yarn - 実測値による比較
[21] ディスク効率性 - https://refine.dev/blog/pnpm-vs-npm-and-yarn/ - 100プロジェクトでの比較
[22] npm workspaces - https://docs.npmjs.com - モノレポサポート機能
[23] npm workspace制限 - https://nodesource.com/blog/nodejs-package-manager-comparative-guide-2024 - 基本機能の説明
[24] pnpm workspaces - https://pnpm.io/workspaces - ネイティブworkspacesサポート
[25] Turborepo統合 - https://nhost.io/blog/how-we-configured-pnpm-and-turborepo-for-our-monorepo - ベストプラクティス
[26] 企業採用事例 - https://vinayak-hegde.medium.com/building-a-monorepo-with-pnpm-and-turborepo-a-journey-to-efficiency-cfeec5d182f5 - 大規模企業での実装
[27] npmセキュリティ - https://nodejs.org/en/blog/vulnerability/january-2025-security-releases - セキュリティリリース
[28] 脆弱性検出 - https://documentation.solarwinds.com/en/success_center/npm/content/release_notes/npm_2025-2_release_notes.htm - 2025年改善点
[29] pnpmセキュリティ - https://pnpm.io/faq - 構造的セキュリティ
[30] 意図しないアクセス防止 - https://dev.to/chlorine/how-does-pnpm-work-5mh - アクセス制御の仕組み
[31] シンプルプロジェクト - https://prateeksha.com/blog/pnpm-vs-npm-vs-yarn-key-differences-and-which-one-you-should-use-in-2025 - npmの適用範囲
[32] 互換性重視 - https://medium.com/@rameshkannanyt0078/npm-vs-pnpm-choosing-the-best-package-manager-for-your-javascript-projects-88f3736e8403 - 安定性の重要性
[33] 標準ツール使用 - https://dev.to/kirteshbansal/choosing-the-right-javascript-package-manager-in-2025-npm-vs-yarn-vs-pnpm-vs-bun-2jie - デフォルト選択
[34] 大規模プロジェクト - https://itsharkz.com/turborepo-monolithic-approach-fullstack-solution/ - pnpmの強み
[35] パフォーマンス重視 - https://glitchedgoblet.blog/post/pnpm - 速度とディスク効率
[36] 最新ツール採用 - https://dev.to/hamzakhan/npm-vs-yarn-vs-pnpm-which-package-manager-should-you-use-in-2025-2f1g - イノベーション重視
[37] ハードリンク詳細 - https://dev.to/chlorine/how-does-pnpm-work-5mh - 技術的実装
[38] ストア構造 - https://pnpm.io/symlinked-node-modules-structure - ファイル参照の仕組み
[39] シンボリックリンク - https://stackoverflow.com/questions/64729963/how-to-make-pnpm-use-symlinks-for-a-global-directory - リンク構築方法
[40] 依存関係ツリー - https://pnpm.io/cli/link - ツリー構造の構築
[41] Windowsジャンクション - https://pnpm.io/faq - Windows固有の実装
[42] 権限不要動作 - https://pnpm.io/settings - 管理者権限の回避
[43] CoW対応 - https://pnpm.io/blog/2020/10/17/node-modules-configuration-options-with-pnpm - ファイルシステム最適化
[44] clone方式推奨 - https://pnpm.io/settings - 最速の方法
[45] pnpmインストール - https://pnpm.io - インストール手順
[46] ロックファイル変換 - https://pnpm.io/cli/import - importコマンドの使用
[47] クリーンアップ - https://medium.com/@_hanglucas/monorepo-using-pnpm-workspaces-integrating-nest-next-js-prisma-and-docker-a4b16dd1d58d - 移行前の準備
[48] 再インストール - https://www.prisma.io/docs/guides/use-prisma-in-pnpm-workspaces - pnpmでの再構築
[49] 2025年展望 - https://savvycomsoftware.com/blog/node-js-features-will-they-be-better/ - 今後の改善予定
[50] IDE統合 - https://daily.dev/blog/whats-new-in-nodejs-2024 - ツールチェーン対応
[51] エンタープライズ採用 - https://romanglushach.medium.com/comparing-npm-yarn-and-pnpm-package-managers-which-one-is-right-for-your-distributed-project-to-4d7de2f0db8e - 企業での採用加速

---

```json
{
  "handoff": {
    "recommended_type": "technical_comparison",
    "audience": "developers",
    "key_messages": [
      "pnpmは速度とディスク効率で圧倒的優位性",
      "主要フレームワークがpnpmへ移行済み",
      "モノレポ開発ではpnpm+Turborepoが2025年のベストプラクティス",
      "npmは安定性重視のシンプルプロジェクト向け"
    ],
    "asset_suggestions": [
      "表: npm vs pnpm機能比較マトリックス",
      "図: pnpmの2層リンク構造アーキテクチャ",
      "グラフ: インストール速度とディスク使用量の比較",
      "フローチャート: npm→pnpm移行手順"
    ]
  }
}
```